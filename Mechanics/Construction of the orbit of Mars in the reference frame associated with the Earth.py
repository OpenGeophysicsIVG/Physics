"""
Пример, переведенный на Python из книги
Компьютерное моделирование физических процессов и систем
в пакете MATLAB. Учебное пособие для вузов. - М.: Горячая
линия - Телеком, 2024. - 808 с:
стр. 17, листинг Glava1_4.m
"""

import numpy as np
import matplotlib.pyplot as plt

# Задание исходных параметров
T1 = 365.24           # период обращения Земли вокруг Солнца (сутки)
Am = 2.28e8           # радиус орбиты Марса (м)
Tm = 689.98           # период обращения Марса вокруг Солнца (сутки)
E = 0.093             # эксцентриситет орбиты Марса
Np = 1000             # число точек на один оборот Марса
K = 9                 # число оборотов Марса вокруг Солнца
Rl = 1.496e8         # радиус орбиты Земли (м) — добавлено, т. к. используется в расчётах

# Вычисление шага изменения переменной ksi
dksi = (2 * np.pi) / Np * K

# Вычисление значений координат вектора ksi
ksi = np.linspace(0, 2 * np.pi * K, int(2 * np.pi * K / dksi) + 1)

# Вычисление временной сетки по формуле (1.10)
T = Tm / (2 * np.pi) * (ksi - E * np.sin(ksi))

# Вычисление мгновенных значений проекции радиуса-вектора Марса на ось OX (формула 1.8)
Xm = Am * (np.cos(ksi) - E)

# Вычисление мгновенных значений проекции радиуса-вектора Марса на ось OY (формула 1.9)
Ym = Am * np.sqrt(1 - E**2) * np.sin(ksi)

# Вычисление мгновенных значений проекции радиуса-вектора Земли на ось OX
Xz = Rl * np.cos(2 * np.pi * T / T1)

# Вычисление мгновенных значений проекции радиуса-вектора Земли на ось OY
Yz = Rl * np.sin(2 * np.pi * T / T1)

# Вычисление проекций радиуса-вектора Марса в системе отсчёта, связанной с Землёй
Xotn = Xm - Xz
Yotn = Ym - Yz

# Визуализация орбиты Марса и начального положения
plt.figure(figsize=(10, 10))
plt.plot(Xotn, Yotn, label='Орбита Марса (в СО Земли)', color='blue')

# Отображение начального положения Марса (первый элемент массивов)
plt.plot(Xotn[0], Yotn[0],
         marker='s',           # квадратный маркер
         color='blue',
         markeredgecolor='b', # цвет границы маркера
         markerfacecolor='g', # цвет заливки маркера
         markersize=5,        # размер маркера
         label='Начальное положение Марса')

plt.gca().set_aspect('equal', adjustable='box')  # равные пропорции осей
plt.xlabel('X (м)')
plt.ylabel('Y (м)')
plt.title('Орбита Марса в системе отсчёта, связанной с Землёй')
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()
